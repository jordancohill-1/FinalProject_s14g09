{% extends "layouts/default.html" %}
{% block content %}

{% if results is defined %}
    <div class="container container-wide">
      <div class="row">
        <div class="col">
          <h1>RESULTS</h1>
          <p>
            Our machine learning algorithms have done their work. View information below.
          </p>
          <hr class="hr-dotted">
        </div>
      </div>
      <div class="row">
        <div class="col">
          <h2>COLOR QUANTIZATION</h2>
          <p>
            Color quantization finds the most prevalent color in movie posters.
            A quantization process creates a copy of the original poster with
            the 4 dominant colors. A second process uses this image to find the
            most prevalant color. With a linear regression model and a decision
            tree regressor, a predicted IMDB score has been generated.
          </p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-5">
          <div class="card">
            <img class="card-img-top" src="{{url_for('static', filename=results['og_file'])}}">
            <div class="card-body">
              <h3 class="card-title mb-1">ORIGINAL</h3>
              <p class="card-text">This image is provided to the quantizer.</p>
            </div>
          </div>
        </div>
        <div class="col-md-2 d-flex align-self-center justify-content-center flex-column">
            <svg class="quant-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12l-20 12 7.289-12-7.289-12z" fill="#2d3748"/></svg>
          </div>
        <div class="col-md-5">
          <div class="card">
            <img class="card-img-top" src="{{url_for('static', filename=results['quant_file'])}}">
            <div class="card-body">
              <h3 class="card-title mb-1">QUANTIZED</h3>
              <p class="card-text">This image is generated by the quantizer.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-3">
        <div class="offset-lg-2 col-lg-9">
          <h2>QUANTIZATION RESULTS</h2>
          <p>The most prevalent color is extracted from the poster and a rating for the movie is predicted.</p>
        </div>
      </div>
      <div class="d-flex row align-self-center justify-content-center">
        <div class="col col-md-4 col-lg-3 pb-3 pb-md-0">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title mb-1">DOMINANT COLOR</h3>
              <p class="card-text results">
                {{results['dominant_color'] | upper }}
              </p>
            </div>
          </div>
        </div>
        <div class="col col-md-4 col-lg-3 pb-3 pb-md-0">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title mb-1">GENERAL COLOR</h3>
              <p class="card-text results">
                {{results['general_color'] | upper}}
              </p>
            </div>
          </div>
        </div>
        <div class="col col-md-4 col-lg-3">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title mb-1">PREDICTED SCORE</h3>
              <p class="card-text results">
                  {{results['score_predict']}}/10
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <hr class="hr-dotted">
        </div>
      </div>
      <div class="row">
        <div class="offset-lg-2 col-lg-8">
          <h2>FACE DETECTION + RECOGNITION</h2>
          <p>
            Our algorithm uses a Convoluted Neural Network (CNN) to identify
            the faces in a poster. It then compares the face to a database of
            100 faces, choosing the face with the smallest euclidian distance
            to the face in the poster.
          </p>
        </div>
      </div>
      <div class="row pb-3">
        <div class="col-md-6 offset-lg-2 col-lg-4">
          <div class="card">
            <img class="card-img-top" src="{{url_for('static', filename=results['face_file'])}}">
            <div class="card-body">
              <h3 class="card-title mb-1">PROCESSED</h3>
              <p class="card-text">Boxes are drawn around faces identified by the algorithm, with names, if known, underneath.</p>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-4 pt-3 pt-md-0">
          <h2>FACE RESULTS</h2>
          <div class="card mb-3">
            <div class="card-body">
              <h3 class="card-title mb-1">NUMBER OF FACES</h3>
              <p class="card-text results mb-0">{{ results['num_faces'] }}</p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h3 class="card-title mb-1">IDENTIFIED ACTORS</h3>
              <ul>
                {% for actor in results['identified_actors'] %}
                <li>{{ actor }}</li>
                {% endfor %}
              </ul>
              {% if results['identified_actors'] == [] %}
              <p class="mb-0"> 
                NO ACTORS IDENTIFIED
              </p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
{% else %}
<div class="container container-thin">
  <div class="row">
    <div class="col">
      <h1>RESULTS</h1>
      <p>
        No image analyzed yet. Go to <a src="{{url_for('upload')}}">Upload Image</a>.
      </p>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}